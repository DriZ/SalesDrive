<!DOCTYPE html>
<html lang="ru">
  	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
		<script src="js/jquery.min.js" type="application/javascript"></script>
		<script src="js/bootstrap.bundle.min.js" type="application/javascript"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
		<style>
	  		body {
				font-family: sans-serif;
				padding-top: 80px;
				width: 300px;
				height: 400px;
				transition: background-color 0.3s ease, color 0.3s ease;
			}
			input {
				width: 100%;
				margin-bottom: 8px;
				transition: background-color 0.3s ease, color 0.3s ease;
			}
	  		button {
				width: 100%;
				margin-bottom: 12px;
				transition: background-color 0.3s ease, color 0.3s ease;
			}

  			.key-item {
				margin-bottom: 6px;
				font-size: 14px;
			}

  			#previewList input[type="checkbox"] {
			    margin-top: 2px;
			    cursor: pointer;
			}

			#previewList div {
			    align-items: center;
			    gap: 8px;
			}

			/*#statusMessage.show {*/
			/*	display: block;*/
			/*	opacity: 1;*/
			/*}*/

			/*#statusMessage.hide {*/
			/*	display: none;*/
			/*	opacity: 0;*/
			/*	transition: opacity 0.5s ease;*/
			/*}*/

			.status-box {
				display: none;
				padding: 10px 12px;
				border: 1px solid transparent;
				border-radius: 8px;
				font-size: 14px;
				line-height: 1.4;
				max-width: 100%;
			}
			.status-icon { margin-right: 8px; }

			.status--success { background: #d1e7dd; color: #0f5132; border-color: #badbcc; }
			.status--error   { background: #f8d7da; color: #842029; border-color: #f5c2c7; }
			.status--info    { background: #cff4fc; color: #055160; border-color: #b6effb; }
			.status--warning { background: #fff3cd; color: #664d03; border-color: #ffecb5; }

			body.dark-theme {
				background-color: #1e1e1e;
				color: #f0f0f0;
			}

			body.dark-theme input,
			body.dark-theme button,
			body.dark-theme .dropdown-menu {
				background-color: #2c2c2c;
				color: #f0f0f0;
				border-color: #444;
			}

			body.dark-theme .dropdown-menu {
				box-shadow: 0 2px 6px rgba(255,255,255,0.05);
			}

			body.dark-theme input::placeholder {
				color: rgba(255, 255, 255, 0.6);
			}

			.dropdown {
				position: relative;
			}

			.dropdown-toggle {
				background: none;
				border: none;
				font-size: 1.4em;
				cursor: pointer;
			}

			.dropdown-menu {
				opacity: 0;
				visibility: hidden;
				transform: translateY(-10px);
				transition: opacity 0.3s ease, transform 0.3s ease;
				position: absolute;
				right: 0;
				top: 100%;
				background-color: #fff;
				border: 1px solid #ccc;
				padding: 6px;
				box-shadow: 0 2px 6px rgba(0,0,0,0.15);
				z-index: 1000;
				min-width: 160px;
			}

			.dropdown:hover .dropdown-menu {
				display: block;
				opacity: 1;
				visibility: visible;
				transform: translateY(0);
			}

			.header {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				z-index: 1000;
				padding-bottom: 6px;
				background-color: #fff;
				transition: box-shadow 0.3s ease;
				border-bottom: 1px solid rgba(255,255,255,0.1);
			}

			body.dark-theme .header {
				background-color: #1e1e1e;
				border-bottom: 1px solid rgba(255,255,255,0.45);
			}

			.header-left {
				flex-shrink: 0;
				margin-left: 16px;
			}

			.header-center {
				padding: 0 16px;
			}

			.header-right {
				flex-shrink: 0;
				margin-right: 16px;
				margin-top: 16px;
			}
			body.dark-theme .modal-content {
				background-color: #2c2c2c;
				color: #f0f0f0;
				border: 1px solid #444;
			}
			body.dark-theme .modal-header,
			body.dark-theme .modal-footer {
				border-color: #444;
			}
			body.dark-theme .modal-title {
				color: #f0f0f0;
			}
			body.dark-theme .modal-body {
				color: #e6e6e6;
			}

			/* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è (–∏–∫–æ–Ω–∫–∞ –∫—Ä–µ—Å—Ç–∏–∫–∞) */
			body.dark-theme .btn-close {
				filter: invert(1) grayscale(100%);
				opacity: .8;
			}
			body.dark-theme .btn-close:hover {
				opacity: 1;
			}

			/* –ë—ç–∫–¥—Ä–æ–ø –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á—É—Ç—å –ø–ª–æ—Ç–Ω–µ–µ –Ω–∞ —Ç–µ–º–Ω–æ–º —Ñ–æ–Ω–µ */
			body.dark-theme .modal-backdrop.show {
				opacity: .75; /* –¥–µ—Ñ–æ–ª—Ç ~.5 */
			}

			/* –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏, —á—Ç–æ–±—ã –±—ã–ª–∏ –≤ –æ–¥–Ω–æ–º —Å—Ç–∏–ª–µ */
			body.dark-theme .modal-content input,
			body.dark-theme .modal-content select,
			body.dark-theme .modal-content textarea {
				background-color: #2c2c2c;
				color: #f0f0f0;
				border-color: #444;
			}

			/* –§–æ–∫—É—Å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–≤–∏–¥–∏–º—ã–π –∫–æ–Ω—Ç—É—Ä –Ω–∞ —Ç–µ–º–Ω–æ–º —Ñ–æ–Ω–µ) */
			body.dark-theme .modal-content .form-control:focus,
			body.dark-theme .modal-content .form-select:focus,
			body.dark-theme .modal-content .btn:focus {
				box-shadow: 0 0 0 .2rem rgba(255,255,255,.15);
				border-color: #666;
			}
			.kbd-badge {
				background: #eee;
				border-radius: 4px;
				padding: 2px 6px;
				font-size: 0.9rem;
				font-family: monospace;
				color: #333;
				margin-left: 6px;
			}

		</style>
		<title>SalesDrive Tools</title>
	</head>
  	<body>
		<div class="header d-flex align-items-center justify-content-between">
			<div class="header-left d-flex align-items-center">
				<img src="img/icon.png" width="32" height="32" alt="Logo" class="rounded me-2">
			</div>
			<div class="header-center flex-grow-1 text-center">
				<h5 class="mb-0">SalesDrive Helper</h5>
			</div>
			<div class="header-right">
				<div id="settingsDropdown" class="dropdown">
					<button class="dropdown-toggle">‚öôÔ∏è</button>
					<div class="dropdown-menu" aria-labelledby="settingsDropdown">
						<button type="button" id="langToggleBtn" class="btn btn-sm btn-outline-primary">üåê –ó–º—ñ–Ω–∏—Ç–∏ –º–æ–≤—É</button>
						<button type="button" id="themeToggleBtn" class="btn btn-sm btn-outline-dark">üåô –ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É</button>
						<button type="button" id="importBtn" class="btn btn-sm btn-outline-primary">üì• –Ü–º–ø–æ—Ä—Ç</button>
						<button type="button" id="exportBtn" class="btn btn-sm btn-outline-primary">üì§ –ï–∫—Å–ø–æ—Ä—Ç</button>
					</div>
				</div>
			</div>
		</div>

		<div id="editFormTemplate" class="d-none">
			<form id="editForm">
				<div class="mb-2 has-validation">
					<label for="editValue" class="form-label">API-–∫–ª—é—á</label>
					<input type="text" class="form-control" id="editValue" placeholder="API –∫–ª—é—á SalesDrive" required>
					<div id="apiKeyLoader" class="text-center my-2" style="display: none;">
						<i class="fas fa-spinner fa-spin text-primary" style="font-size: 1.2em;"></i>
					</div>
					<div class="invalid-feedback" id="enterValidKey">
						–í–≤–µ–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª—é—á (100 —Å–∏–º–≤–æ–ª–æ–≤).
					</div>
				</div>
				<div class="mb-2">
					<label for="editName" class="form-label" id="editNameText">–ò–º—è –∫–ª—é—á–∞</label>
					<input type="text" class="form-control" id="editName" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–Ω—è—Ç–Ω–æ–µ –∏–º—è –∫–ª—é—á–∞" required>
				</div>
			</form>
		</div>

		<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
					</div>
					<div class="modal-body"></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-danger" id="confirmModalOk">–£–¥–∞–ª–∏—Ç—å</button>
						<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal" id="cancel">–û—Ç–º–µ–Ω–∞</button>
					</div>
				</div>
			</div>
		</div>

		<div class="px-2 mb-2">
			<div class="px-2 my-2 status-box" id="statusMessage" style="display: none;">
				<span class="status-icon" id="statusIcon" style="margin-right: 6px;"></span>
				<span class="status-text" id="statusText"></span>
			</div>
		</div>

		<div id="keysList" class="px-2"></div>
<!--		<div class="px-2">-->
<!--			<button id="addKey" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á</button>-->
<!--			<button id="clearAllBtn" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏</button>-->
<!--		</div>-->
		<script src="js/popup.js"></script>
		<div id="previewContainer" class="px-2" style="margin-top: 10px; display: none;">
			<h5 id="previewText">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–ª—é—á–µ–π:</h5>
			<div style="margin-bottom: 8px;">
				<button id="selectAllBtn" class="btn btn-sm btn-outline-primary">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
				<button id="deselectAllBtn" class="btn btn-sm btn-outline-secondary">–°–Ω—è—Ç—å –≤—Å–µ</button>
			</div>
			<div id="previewList"></div>
			<button id="confirmImportBtn" class="btn btn-success btn-sm">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
			<button id="cancelImportBtn" class="btn btn-secondary btn-sm">–û—Ç–º–µ–Ω–∞</button>
		</div>
		<div id="toastContainer" style="
			position: fixed;
			top: 20px;
			right: 20px;
			z-index: 1055;
			display: flex;
			flex-direction: column;
			align-items: flex-end;
		"></div>
	</body>
</html>
